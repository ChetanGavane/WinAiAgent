<Window x:Class="WinAiAgent.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="WinAiAgent"
        Width="500"
        Height="120"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        Topmost="True"
        ShowInTaskbar="False"
        ResizeMode="NoResize"
        Opacity="0"
        Loaded="Window_Loaded"
        KeyDown="Window_KeyDown">
    <Grid>
        <Grid.Resources>
            <Style x:Key="IconButtonStyle" TargetType="Button">
                <Setter Property="Width" Value="40"/>
                <Setter Property="Height" Value="40"/>
                <Setter Property="Background" Value="Transparent"/>
                <Setter Property="BorderThickness" Value="0"/>
                <Setter Property="Cursor" Value="Hand"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Border x:Name="Root" CornerRadius="20" Background="{TemplateBinding Background}">
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="Root" Property="Background" Value="#14000000"/>
                                </Trigger>
                                <Trigger Property="IsPressed" Value="True">
                                    <Setter TargetName="Root" Property="Background" Value="#22000000"/>
                                </Trigger>
                                <Trigger Property="IsEnabled" Value="False">
                                    <Setter TargetName="Root" Property="Opacity" Value="0.5"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </Grid.Resources>

        <Grid HorizontalAlignment="Center" VerticalAlignment="Top" Margin="0,50,0,0">
            <Border x:Name="SearchBar" CornerRadius="25" Width="400" Height="50" BorderBrush="{DynamicResource SearchBorderBrush}" BorderThickness="1">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                        <GradientStop Color="{DynamicResource SearchBackgroundTop}" Offset="0"/>
                        <GradientStop Color="{DynamicResource SearchBackgroundBottom}" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="50" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="50" />
                    </Grid.ColumnDefinitions>

                    <Button Grid.Column="0" x:Name="MicButton" Style="{StaticResource IconButtonStyle}" Click="MicButton_Click" ToolTip="Voice input">
                        <Path Data="M12,2 C9.790861,2 8,3.790861 8,6 L8,12 C8,14.209139 9.790861,16 12,16 C14.209139,16 16,14.209139 16,12 L16,6 C16,3.790861 14.209139,2 12,2 Z M6,11 L6,12 C6,15.313708 8.6862915,18 12,18 C15.313708,18 18,15.313708 18,12 L18,11 L16,11 L16,12 C16,14.209139 14.209139,16 12,16 C9.790861,16 8,14.209139 8,12 L8,11 L6,11 Z M11,20 L11,22 L13,22 L13,20 L11,20 Z" Fill="{DynamicResource SearchIconBrush}" Stretch="Uniform" Width="20" Height="20" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Button>

                    <TextBox Grid.Column="1" x:Name="InputBox" Margin="0" BorderThickness="0" Background="Transparent" Foreground="{DynamicResource TextForeground}"
                             FontFamily="Segoe UI" FontSize="14" VerticalContentAlignment="Center" Padding="4" CaretBrush="{DynamicResource TextForeground}"
                             TextChanged="InputBox_TextChanged"/>

                    <Button Grid.Column="2" x:Name="SendButton" Style="{StaticResource IconButtonStyle}" Click="SendButton_Click" ToolTip="Send">
                        <Path Data="M2,21 L23,12 L2,3 L2,10 L17,12 L2,14 L2,21 Z" Fill="{DynamicResource SearchIconBrush}" Stretch="Uniform" Width="18" Height="18" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Button>
                </Grid>
            </Border>

            <Rectangle x:Name="ActivityRing" Width="400" Height="50" RadiusX="25" RadiusY="25" Fill="Transparent" StrokeThickness="2.5"
                       IsHitTestVisible="False" Opacity="0">
                <Rectangle.Stroke>
                    <LinearGradientBrush x:Name="RingBrush" StartPoint="0,0.5" EndPoint="1,0.5" MappingMode="RelativeToBoundingBox">
                        <LinearGradientBrush.GradientStops>
                            <GradientStop Color="#FFFBBC05" Offset="0.0"/>
                            <GradientStop Color="#FFFF6E00" Offset="0.25"/>
                            <GradientStop Color="#FFFF2D55" Offset="0.5"/>
                            <GradientStop Color="#FF5856D6" Offset="0.75"/>
                            <GradientStop Color="#FF34C759" Offset="1.0"/>
                        </LinearGradientBrush.GradientStops>
                        <LinearGradientBrush.RelativeTransform>
                            <RotateTransform Angle="0" CenterX="0.5" CenterY="0.5"/>
                        </LinearGradientBrush.RelativeTransform>
                    </LinearGradientBrush>
                </Rectangle.Stroke>
            </Rectangle>
        </Grid>

        <Border x:Name="Toast" Background="{DynamicResource ToastBackground}" CornerRadius="8" Padding="8,4" BorderBrush="{DynamicResource SearchBorderBrush}" BorderThickness="1"
                HorizontalAlignment="Center" VerticalAlignment="Top" Margin="0,110,0,0" Opacity="0" IsHitTestVisible="False">
            <TextBlock x:Name="ToastText" Text="" Foreground="{DynamicResource ToastForeground}" FontFamily="Segoe UI" FontSize="12"/>
        </Border>
    </Grid>
</Window>

